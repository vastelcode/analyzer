import re

ready_regex = {
    # Электронная почта (улучшенный RFC-совместимый вариант)
    'email': re.compile(
        r'(?:[a-z0-9!#$%&\'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+/=?^_`{|}~-]+)*|'
        r'"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")'
        r'@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?',
        re.IGNORECASE
    ),
    
    # Телефон РФ (улучшенный вариант с захватом кода страны)
    'phone_ru': re.compile(
        r'(?:\+7|8)[\s\-]?\(?\d{3}\)?[\s\-]?\d{3}[\s\-]?\d{2}[\s\-]?\d{2}\b'
    ),
    
    # Дата в формате DD-MM-YYYY (с улучшенной валидацией)
    'date': re.compile(
        r'\b(?:0[1-9]|[12][0-9]|3[01])[-/.](?:0[1-9]|1[0-2])[-/.](?:19|20)\d{2}\b'
    ),
    
    # Время в формате HH:MM:SS (24-часовой формат, с необязательными секундами)
    'time': re.compile(
        r'\b(?:[01]?[0-9]|2[0-3]):[0-5][0-9](?::[0-5][0-9])?\b'
    ),
    
    # URL с протоколом (улучшенная версия)
    'url': re.compile(
        r'\b(?:https?|ftp)://'
        r'(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+'
        r'[a-zA-Z]{2,}(?::\d{2,5})?'
        r'(?:/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?\b',
        re.IGNORECASE
    ),
    
    # IPv4 адрес (исправленное)
    'ipv4': re.compile(
        r'\b(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.'
        r'(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.'
        r'(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.'
        r'(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b'
    ),
    
    # Целое число (с границами слова)
    'integer': re.compile(r'\b-?\d+\b'),
    
    # Число с плавающей точкой (включая числа без целой части)
    'float': re.compile(
        r'\b-?(?:\d+\.\d*|\.\d+|\d+)(?:[eE][+-]?\d+)?\b'
    ),
    
    # HEX цвет (#RGB, #RGBA, #RRGGBB, #RRGGBBAA)
    'hex_color': re.compile(
        r'#(?:[0-9a-fA-F]{3,4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})\b'
    ),
    
    # Логин (должен начинаться с буквы, 3-20 символов)
    'username': re.compile(r'\b[a-zA-Z][a-zA-Z0-9_]{2,19}\b'),
    
    # Почтовый индекс РФ (6 цифр, возможно с пробелом)
    'postal_code_ru': re.compile(r'\b\d{6}\b'),
    
    # Координаты (улучшенный вариант)
    'coordinates': re.compile(
        r'\b-?\d{1,3}(?:\.\d+)?\s*[,;]\s*-?\d{1,3}(?:\.\d+)?\b'
    ),
    
    # IMEI телефона (15 или 16 цифр)
    'imei': re.compile(r'\b\d{15,16}\b'),
    
    # Номер банковской карты (с разделителями)
    'credit_card': re.compile(
        r'\b(?:\d[ -]*?){13,19}\b'
    ),
    
    # UUID (все версии)
    'uuid': re.compile(
        r'\b[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}\b',
        re.IGNORECASE
    ),
    
    # Дополнительно: Валидация пароля (минимум 8 символов, буквы в обоих регистрах и цифры)
    'password': re.compile(
        r'^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d@$!%*?&]{8,}$'
    ),
}

